# One-Pager: Система прогнозирования оттока клиентов

## Бизнес-проблема
Компании теряют доход из‑за ухода клиентов. Своевременное прогнозирование оттока позволяет заранее выявлять пользователей с высоким риском и принимать меры по их удержанию. Цель сервиса — давать простое и понятное предсказание, которое может быть интегрировано в бизнес‑процессы.

## Данные
Для построения модели используется историческая информация о поведении клиентов: частота покупок, суммы чеков, время от последней активности, пользование сервисами. В демо‑версии используются упрощённые числовые признаки (4 признака), чтобы показать работу сервиса.

## ML‑модель
Базовая модель — логистическая регрессия, обученная оффлайн на подготовленных данных. Модель предсказывает вероятность оттока и классифицирует клиентов на два класса. Переобучение модели запускается периодически с помощью Airflow. В дальнейшем модель может быть заменена на более сложные алгоритмы ( градиентный бустинг, нейронные сети ).

## Архитектура сервиса
- **ML‑сервис** на FastAPI обрабатывает запросы на предсказание, делает inference внутри контейнера и пишет результаты в базу данных.
- **База данных PostgreSQL** хранит исходные данные, результаты предсказаний, фичи и метаданные.
- **Брокер сообщений Kafka** обеспечивает асинхронную обработку и передачу данных между компонентами.
- **Оркестратор Airflow** выполняет расчёт фичей, загрузку данных и переобучение модели по расписанию.
- **Веб‑интерфейс Streamlit** позволяет пользователю ввести значения признаков, получить результат и просмотреть историю предсказаний.
- **Мониторинг Grafana + Prometheus** показывает ключевые метрики сервиса ( число запросов, распределение предсказаний, логов ) и бизнес‑метрики.

## Метрики и ценность
Ключевые метрики для оценки модели: Accuracy, Precision, Recall и AUC‑ROC. Бизнес‑метрики: доля клиентов с высоким риском, вовремя получивших предложение, снижение фактического оттока. В демо‑версии реализован счётчик общего числа предсказаний и сохранение результатов в базу.

## Технологический стек
Docker, docker‑compose, Python 3.9, FastAPI, scikit‑learn, Streamlit, PostgreSQL, Kafka, Airflow, Grafana, Prometheus.

## План развития
- Добавить новые признаки и более точные модели.
- Реализовать автоматический выбор порога и уведомления для менеджеров.
- Расширить мониторинг, добавить алертинг и логирование.
- Подключить реальные данные из CRM или базы транзакций.
- Создать систему A/B‑тестирования для оценки эффективности предложений удержания.
